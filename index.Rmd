---
title: "Predicting Drivers of Common Buckthorn"
author: Sean Colby
subtitle: Generation of a Buckthorn SDM
---

# Introduction

Common Buckthorn

Background: 
Common Buckthorn is a deciduous tree/shrub species which was introduced in the late 1800's as an ornamental from Eurasia (Knight et al. 2007). While it may have served a role as an ornamental, it has done a large amount of ecological harm to the Northeastern United States and South East Canada. For example, Common Buckthorn has been known to more than double nitrogen and organic matter content in soils compared to native vegetation resulting in decreased habitat diversity (Klionsky et al. 2011). Furthermore, since Buckthorn is highly competitive having a higher growth rate and fecundity than most native shrubs, it is then able to become quickly become a monoculture and out shade native species. To make matters worse, Buckthorn is allelopathic and reduces native species richness and native biomass production (Warren et al. 2017). 


Problem:
Due to Common Buckthorn being extremely damaging to native ecosystems it is imperative to model its spread in order to attempt to control it. While many researchers have done large multiple state prediction models of Common Buckthorn, to my knowledge very few have done a small scale single state SDM.


Questions: 
1. Will this small scale of an SDM be relatively accurate? 
2. What can we make of the plot as to what forests/areas appear to be more likely to be invaded than others?
3. Since we are focusing on habitat suitability, is buckthorn's presence more likely due to habitat suitability or dispersal methods?


# Materials and methods

Study Area: 
This study area is made up of 160 sites that were randomly selected from the following New York counties; Monroe, Livingston, Wyoming, and Ontario. Using these sites, environmental variables of soil, climatic, vegetation, and topographic data were collected.

```{r}
#Load Library
library(spData)
library(tidyverse)
library(sf)

#Load Sites
sites<-read.csv("160_Sites.csv")%>%
st_as_sf(coords= c("longitude","Ã¯..latitude"),crs=4326)
data(us_states)
NY= us_states[us_states$NAME == "New York",]
NY_SF<-st_as_sf(NY)

ggplot(NY_SF, col = "grey95")+
  geom_sf()+
  geom_sf(data= sites, pch=4)
```

Methods:

Generating Logistic Regression to Find Predictors for SDM

Data for Logistic Regression: 
(FIll in Later)

Logisitic Regression Codes:
```{r}
#Load in Libraries
library(tidyverse)
library(stats)

#Read in Data
Buckthorn_All_Sites <- read.csv("All_Sites.csv")

#Calculate Logistic Regression Using What Variables are believed to be best
Buckthorn_All <- glm(formula= Buckthorn~temp0509+GR0.50+Compaction+Clay+terrain.slope+pH,data=Buckthorn_All_Sites, family="binomial")

#Note that you must type in each variable and play with testing variables that both make the most sense as well as yield the best p-value. 

```

Using the same stats package to fit linear models and predict what controls Common Buckthorn's relative abundance
-*Note* this is an additional test to not only create a habitat suitability model of buckthorn, but to also see what environmental variable increases abundance beyond just presence absence. 

```{r, message=F, warning=F}
#Load in the Libraries
library(tidyverse)
library(stats)

#Read in Data that contains only "invaded" sites
Buckthorn_only <- read.csv("Buckthorn_only.csv")

#Create Linear Model using what variables are believed to be best
Buckthorn <- lm(formula = X.Buckthorn~temp0509+nonveg.100+Canopy.Cover, data= Buckthorn_only)
knitr::opts_chunk$set(cache=TRUE)  # cache the results for quick compiling
```

## Download and clean all required data
```{r}
n=20
data=data.frame(x=runif(n,-180,180),
                y=runif(n,-60,60),
                size = runif(n, 5, 20),
                category = factor(
                  sample(letters[1:5], n, replace = TRUE)
                  ),
                value = rnorm(n))
```

```{r, results='asis'}
data %>% 
  slice(1:10) %>% #show only 1:n rows
  kable(digits=2,align="c")%>% #make table and round to two digits
  kable_styling(bootstrap_options = 
                  c("striped", "hover", "condensed", "responsive")) #apply other formatting
```

Add any additional processing steps here.

# Results

USE SUMMARY FUNCTION OF BOTH LOGISITC AND LINEAR REGRESSIONS

```{r, fig.width=6, fig.height=3, fig.cap="Map of completely random data"}
m <- leaflet(data) %>% 
  addTiles() %>% 
  addCircleMarkers(~x, ~y, radius = ~size,color = ~as.factor(category)) %>% 
  addPopups(~x[2], ~y[2], "Random popup")
m  # a map with the default OSM tile layer
```

USE GGPLOT OF SDM FUNCTION
```{r}
data %>% 
  ggplot(aes(x=x,y=y,col=category))+
  geom_point()
```

# Conclusions

[~200 words]

Clear summary adequately describing the results and putting them in context. Discussion of further questions and ways to continue investigation.

# References

All sources are cited in a consistent manner
